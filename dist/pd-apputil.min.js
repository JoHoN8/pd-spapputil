!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("jquery"),require("pd-sputil")):"function"==typeof define&&define.amd?define(["jquery","pd-sputil"],t):"object"==typeof exports?exports.pdspapputil=t(require("jquery"),require("pd-sputil")):e.pdspapputil=t(e.$,e.pdsputil)}(this,function(e,t){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=2)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){var t,n=location,i=encodeURIComponent(e),o=r.i(c.URLparameters)(n.search);t=n.pathname+"?ID="+o.ID+"&Source="+i,a("#aspnetForm").attr("action",t)}function o(e){e.children("tbody").find("tr").each(function(){var e,t,r=a(this).find("td.ms-vb").find("span");e=r.text(),t=e.split("\\"),t.length>1&&r.text(t[t.length-1])})}function l(e,t,r){var n,i=e||{},o=i.startIndex||0,l=i.totalPerTrip||100,c=t.length;for(i.batchItems=[],o;o<c;o++)if(n=r.call(i,t[o]),n&&i.batchItems.push(n),i.batchItems.length===l){o++;break}return i.startIndex=o,i}Object.defineProperty(t,"__esModule",{value:!0}),t.setFormSource=i,r.d(t,"errorHandler",function(){return s}),t.correctAttachmentTableNames=o,t.prepBatchInfo=l,r.d(t,"peoplePicker",function(){return p}),r.d(t,"termPicker",function(){return d});var c=r(1),u=(r.n(c),function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()),a=r(0),s=function(){function e(){n(this,e),this.errorContainer=[]}return u(e,[{key:"getErrors",value:function(){return this.errorContainer.slice(0)}},{key:"addErrors",value:function(e){this.errorContainer.push(e)}},{key:"getCount",value:function(){return this.errorContainer.length}},{key:"clearErrors",value:function(){this.errorContainer=[]}},{key:"throwErrorDialog",value:function(e,t,r){var n=t||this.getErrors().join("<br/>");return""===n&&(n="noErrors"),"noErrors"!==n&&SP.UI.ModalDialog.showErrorDialog(e,n,r),n}}]),e}(),p={getPickerField:function(e,t,r){var n=e.find(t).children("div").children("div");if(r){return n.length>0?n.attr("id"):null}return n},removeObjRef:function(e){return SPClientPeoplePicker.SPClientPeoplePickerDict[e]&&delete SPClientPeoplePicker.SPClientPeoplePickerDict[e],SPClientPeoplePicker.SPClientPeoplePickerDict},removeUsers:function(e,t){var r=SPClientPeoplePicker.SPClientPeoplePickerDict[e],n=this.getUsersInfo(e).length;return t&&n>0?(a("#"+e.replace("$","\\$")).find("span.sp-peoplepicker-userSpan").each(function(){r.DeleteProcessedUser(this)}),r):n>0?(r.DeleteProcessedUser(),r):void 0},addUser:function(e,t,r,n){var i=SPClientPeoplePicker.BuildUnresolvedEntity(t,r),o=SPClientPeoplePicker.SPClientPeoplePickerDict[e],l=n||!0;return o.AddUnresolvedUser(i,l),o},getUsersInfo:function(e){return SPClientPeoplePicker.SPClientPeoplePickerDict[e].GetAllUserInfo()},notifiyPeoplePickersReady:function(){function e(){a.isEmptyObject(t)?setTimeout(e,300):n.resolve(t)}var t,n=a.Deferred();return r.i(c.waitForScriptsReady)("clientpeoplepicker.js").then(function(){return t=SPClientPeoplePicker.SPClientPeoplePickerDict,e(),n.promise()})},initializePeoplePicker:function(e){var t={};t.PrincipalAccountType=e.type||"User,DL,SecGroup,SPGroup",t.SearchPrincipalSource=e.Search||15,t.ResolvePrincipalSource=e.Resolve||15,t.AllowMultipleValues=e.MultipleValues||!1,t.MaximumEntitySuggestions=e.EntitySuggestions||50,t.Width=e.width||"250px",SPClientPeoplePicker_InitStandaloneControlWrapper(e.elementId,null,t)}},f={},d={addTerm:function(e,t,r){var n=this.getField(e);return n.setRawText(t+"|"+r),n.retrieveTerms(),!0},removeTerm:function(e,t,r,n){var i,o,l,c=this.getField(e);return t?c.setRawText(""):(i=r+"|"+n,o=c.getRawText().split(";"),l=o.filter(function(e){return e!==i}),c.setRawText(l.join(";"))),c.retrieveTerms(),!0},getField:function(e){return f[e]||(f[e]=new Microsoft.SharePoint.Taxonomy.ControlObject(document.getElementById(e))),f[e]}}}])});